<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="UserDAO">
	<resultMap type="com.planty.jsp.user.model.dto.UserDTO" id="memberResultMap">
		<id property="id" column="ID"/>
		<result property="no" column="AUTH_NO"/>
		<result property="pwd" column="PWD"/>
		<result property="address" column="ADDRESS"/>
		<result property="addressDetail" column="ADDRESS_DETAIL"/>
		<result property="zipcode" column="ZIPCODE"/>
		<result property="name" column="NAME"/>
		<result property="phone" column="PHONE"/>
		<result property="email" column="EMAIL"/>
		<result property="status" column="TEXT_YN"/>
		<result property="enrollDate" column="ENROLL_DATE"/>
		<result property="ceoName" column="CEO_NAME"/>
		<result property="reqNo" column="REQ_NO"/>
		<result property="approval" column="APPROVAL"/>
		
		
	</resultMap>

	
	<select id="selectEncryptedPwd" resultType="java.lang.String">
        SELECT 
               PWD
          FROM MEMBER 
         WHERE ID = #{ id }
	</select>
	
	<select id="selectLoginMember" resultMap="memberResultMap">
		SELECT
			ID,
			AUTH_NO,
			PWD,
			ADDRESS	,
			PHONE,
			EMAIL,
			TEXT_YN,
			ENROLL_DATE,
			NAME
		  FROM MEMBER 
		 WHERE ID = #{ id }
	</select>
	
	<select id="memberIdCheck" resultType="_int">
		SELECT 
		       COUNT(*)
		  FROM MEMBER
		 WHERE ID = #{ id }
	</select>
	
	
	<select id="findId" resultType="memberResultMap">
		SELECT 
			   ID
		 FROM MEMBER 
		 WHERE NAME = #{name} 
		 AND EMAIL = #{email}

	</select>
	
	
	<select id="findPwd" resultType="memberResultMap">
		SELECT 
				*
		 FROM MEMBER 
		 WHERE ID = #{ id } 
		 AND EMAIL = #{email}
		<if test="regNo != null and regNo != ''">
			AND REG_NO = #{ regNo }
		</if>
		 
	</select>
	
	
	<update id="updateMemberPassword">
		UPDATE 
		       MEMBER
		   SET PWD = #{ pwd }
		 WHERE ID = #{ id }
	</update>


</mapper>
